<?xml version="1.0"?>
<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~    https://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
-->
<!--<property>-->
<!--    <name>name</name>-->
<!--    <values>prometheus</values>-->
<!--    <property>-->
<!--        <property>-->
<!--            <name>job_name</name>-->
<!--            <value>job</value>-->
<!--            <description>Job name</description>-->
<!--        </property>-->
<!--        <name>job_targets</name>-->
<!--        <values>-->
<!--            <property>-->
<!--                <name>target1</name>-->
<!--                <value>localhost:9090</value>-->
<!--            </property>-->
<!--        </values>-->
<!--        <description>Job targets</description>-->
<!--    </property>-->
<!--    <property>-->
<!--        <name>job_scrape_interval</name>-->
<!--        <value>5s</value>-->
<!--        <description>scrape targets from this job every scrape_interval.</description>-->
<!--    </property>-->
<configuration>
    <property>
        <name>scrape_jobs</name>
        <values>
            <property>
                <name>scrape_config1</name>
                <values>
                    <property>
                            <name>job_name</name>
                            <value>job</value>
                            <description>Job name</description>
                    </property>
                    <property>
                        <name>job_targets</name>
                        <value>['localhost:9090']</value>
                        <description>Job targets</description>
                    </property>
                    <property>
                        <name>job_scrape_interval</name>
                        <value>5s</value>
                        <description>scrape targets from this job every scrape_interval.</description>
                    </property>
                </values>
                <description>A scrape configuration containing exactly one endpoint to scrape.</description>
            </property>
        </values>
        <description>A scrape configuration containing exactly one endpoint to scrape.</description>
    </property>
    <property>
        <name>content</name>
        <description>This is the freemarker template for prometheus.yml file</description>
        <value><![CDATA[
global:
  scrape_interval:     ${scrape_interval} # By default, scrape targets every 15 seconds.

  # Attach these labels to any time series or alerts when communicating with
  # external systems (federation, remote storage, Alertmanager).
  external_labels:
    monitor: 'codelab-monitor'

# A scrape configuration containing exactly one endpoint to scrape:
# Here it's Prometheus itself.
scrape_configs:
  # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.
  - job_name: 'prometheus'

    # Override the global default and scrape targets from this job every 5 seconds.
    scrape_interval: 5s

    static_configs:
      - targets: ['localhost:9090']

<#list scrape_jobs as job>
  - job_name: '${job.name}'

    scrape_interval: ${job.scrape_interval}

    static_configs:
      - targets: ${job.targets}
</#list>
]]>
        </value>
        <attrs>
            <type>longtext</type>
        </attrs>
    </property>
</configuration>